{"version":3,"sources":["webpack:///./src/pages/drop/DropDetail.vue?956f","webpack:///src/pages/drop/DropDetail.vue","webpack:///./src/pages/drop/DropDetail.vue?12af","webpack:///./src/pages/drop/DropDetail.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","d","key","logoUri","_e","_v","_s","name","chainId","nftInfo","dropTotal","description","image","length","slice","on","claimHandler","staticRenderFns","components","data","id","claimParam","computed","mapState","mapGetters","detail","canClaim","address","mounted","dropid","$api","dropId","then","catch","console","methods","vm","selectedAddress","claimResp","code","msg","web3js","getAllowWeb3js","claimNFT","tokenId","proof","_emsg","regex","jsonStr","errData","JSON","component","VAvatar","VBtn","VCard","VCardActions","VCardTitle","VContainer","VImg","VListItem","VListItemAvatar","VListItemContent","VList","VListItemSubtitle","VListItemTitle"],"mappings":"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","file":"js/player.4dbcb037.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-container',[_c('v-card',{staticClass:\"meta-nftcard\",attrs:{\"elevation\":\"0\",\"outlined\":\"\"}},[_c('v-card-title',[(_vm.d.logoUri)?_c('span',{key:\"drop_logo\"},[_c('v-avatar',[_c('v-img',{attrs:{\"src\":_vm.d.logoUri}})],1)],1):_vm._e(),_c('span',{staticClass:\"title pl-2\"},[_vm._v(\" \"+_vm._s(_vm.d.name)+\" \"+_vm._s(_vm.chainId)+\" \")])]),_c('v-list-item',{attrs:{\"three-line\":\"\"}},[_c('v-list-item-content',[_c('div',{staticClass:\"text-over-line\"},[_c('span',[_vm._v(_vm._s(_vm.d.nftInfo ? _vm.d.nftInfo.name : ''))]),_vm._v(\" \"),_c('span',{staticClass:\"drop-total\"},[_vm._v(\"[\"+_vm._s(_vm.d.dropTotal)+\"]\")])]),_c('v-list-item-title'),_c('v-list-item-subtitle',[_vm._v(\" \"+_vm._s(_vm.d.nftInfo ? _vm.d.nftInfo.description : '')+\" \")])],1),(_vm.d.nftInfo && _vm.d.nftInfo.image)?_c('v-list-item-avatar',{key:\"'img_' + id\",attrs:{\"size\":\"120\",\"tile\":\"\",\"color\":\"grey\"}},[_c('v-img',{attrs:{\"src\":_vm.d.nftInfo.image}})],1):_c('v-list-item-avatar',{key:\"'_spanImg_' + id\",attrs:{\"size\":\"80\",\"tile\":\"\",\"color\":\"grey\"}},[_vm._v(\" \"+_vm._s(_vm.d.nftInfo && _vm.d.nftInfo.name ? (_vm.d.nftInfo.name.length > 3 ? _vm.d.nftInfo.name.slice(0, 3) : _vm.d.nftInfo.name) : '')+\" \")])],1),_c('v-card-actions',[_c('v-btn',{staticClass:\"px-6\",attrs:{\"rounded\":\"\",\"outlined\":\"\",\"small\":\"\",\"text\":\"\"},on:{\"click\":_vm.claimHandler}},[_vm._v(\"Claim\")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <v-container>\n    <v-card class=\"meta-nftcard\" elevation=\"0\" outlined>\n      <v-card-title>\n        <span v-if=\"d.logoUri\" key=\"drop_logo\">\n          <v-avatar><v-img :src=\"d.logoUri\"></v-img> </v-avatar>\n        </span>\n        <span class=\"title pl-2\"> {{ d.name }} {{ chainId }} </span>\n      </v-card-title>\n      <v-list-item three-line>\n        <v-list-item-content>\n          <div class=\"text-over-line\">\n            <span>{{ d.nftInfo ? d.nftInfo.name : '' }}</span> <span class=\"drop-total\">[{{ d.dropTotal }}]</span>\n          </div>\n          <v-list-item-title> </v-list-item-title>\n          <v-list-item-subtitle>\n            {{ d.nftInfo ? d.nftInfo.description : '' }}\n          </v-list-item-subtitle>\n        </v-list-item-content>\n        <v-list-item-avatar v-if=\"d.nftInfo && d.nftInfo.image\" key=\"'img_' + id\" size=\"120\" tile color=\"grey\">\n          <v-img :src=\"d.nftInfo.image\"></v-img>\n        </v-list-item-avatar>\n        <v-list-item-avatar v-else key=\"'_spanImg_' + id\" size=\"80\" tile color=\"grey\">\n          {{\n            d.nftInfo && d.nftInfo.name ? (d.nftInfo.name.length > 3 ? d.nftInfo.name.slice(0, 3) : d.nftInfo.name) : ''\n          }}\n        </v-list-item-avatar>\n      </v-list-item>\n      <v-card-actions>\n        <v-btn rounded outlined small text class=\"px-6\" @click=\"claimHandler\">Claim</v-btn>\n      </v-card-actions>\n    </v-card>\n  </v-container>\n</template>\n\n<script>\nimport { getAllowWeb3js } from '@lib/web3'\nimport { claimNFT } from '@biz/abi/drop-nft-sdk'\nimport { mapGetters, mapState } from 'vuex'\nexport default {\n  name: 'DropDetail',\n  components: {},\n  data: () => ({\n    id: '',\n    claimParam: {},\n  }),\n  computed: {\n    ...mapState('wal', ['chainId']),\n    ...mapGetters('biz', ['dropItems']),\n    ...mapGetters('wal', ['currentAddress']),\n    d() {\n      const dropid = this.id\n      const detail = (this.dropItems || []).find((it) => it.dropid === dropid || it.dropid === parseInt(dropid))\n      return detail || {}\n    },\n    canClaim() {\n      return this.claimParam && this.claimParam.address\n    },\n  },\n  mounted() {\n    const dropid = this.$route.params.id\n    const address = this.$store.state.wal.selectedAddress\n\n    this.id = dropid\n\n    if (address && dropid) {\n      this.$api('drop.getClaimParams', { dropId: dropid, address })\n        .then((resp) => {\n          const { code, msg, data } = resp\n          if (code === 0 && typeof data === 'object') {\n            this.claimParam = data\n          } else {\n            throw new Error(msg || 'not get drop token')\n          }\n        })\n        .catch((ex) => {\n          console.log(ex)\n        })\n    }\n  },\n  methods: {\n    async claimHandler() {\n      const vm = this\n      try {\n        const dropId = this.id\n        const { chainId, selectedAddress } = this.$store.state.wal || {}\n        if (!chainId || !selectedAddress) throw new Error('Please connect wallet')\n\n        if (!dropId) throw new Error('Miss dropid or address')\n\n        const claimResp = await this.$api('drop.getClaimParams', { dropId, address: selectedAddress })\n\n        const { code, msg, data } = claimResp\n\n        if (code !== 0 || typeof data !== 'object' || !data) {\n          throw new Error(msg === 'ok' ? 'Not found your address in this drop' : msg)\n        }\n        const web3js = getAllowWeb3js()\n\n        const receipt = await claimNFT(web3js, {\n          selectedAddress: selectedAddress,\n          dropid: data.dropId,\n          tokenId: data.tokenId,\n          proof: data.proof,\n          chainId,\n        })\n      } catch (ex) {\n        let msg = ex.message\n        console.log('ex', ex.message)\n\n        try {\n          let _emsg = ex.message\n          let regex = 'Internal JSON-RPC error.'\n          if (_emsg.startsWith(regex)) {\n            let jsonStr = _emsg.slice(regex.length).trim()\n            const errData = JSON.parse(jsonStr)\n            msg = errData.message || ex.message\n          }\n        } catch (_) {}\n\n        vm.$toast(msg, 'fail', 10000)\n      }\n    },\n  },\n}\n</script>\n<style lang=\"scss\" scoped></style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./DropDetail.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./DropDetail.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./DropDetail.vue?vue&type=template&id=06bc5c95&scoped=true&\"\nimport script from \"./DropDetail.vue?vue&type=script&lang=js&\"\nexport * from \"./DropDetail.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"06bc5c95\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VAvatar } from 'vuetify/lib/components/VAvatar';\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardActions } from 'vuetify/lib/components/VCard';\nimport { VCardTitle } from 'vuetify/lib/components/VCard';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VImg } from 'vuetify/lib/components/VImg';\nimport { VListItem } from 'vuetify/lib/components/VList';\nimport { VListItemAvatar } from 'vuetify/lib/components/VList';\nimport { VListItemContent } from 'vuetify/lib/components/VList';\nimport { VListItemSubtitle } from 'vuetify/lib/components/VList';\nimport { VListItemTitle } from 'vuetify/lib/components/VList';\ninstallComponents(component, {VAvatar,VBtn,VCard,VCardActions,VCardTitle,VContainer,VImg,VListItem,VListItemAvatar,VListItemContent,VListItemSubtitle,VListItemTitle})\n"],"sourceRoot":""}